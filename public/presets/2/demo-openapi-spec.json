{
  "openapi": "3.0.1",
  "info": {
    "title": "Customer Analytics Preset",
    "description": "A basic customer analytics platform. The user can view the reports you generate on the reports page - tell them this when you create a report.",
    "version": "v1"
  },
  "components": {
    "schemas": {}
  },
  "paths": {
    "/api/v1/segments": {
      "post": {
        "operationId": "createSegment",
        "tags": ["Segments"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Segment name"
                  },
                  "segmentType": {
                    "type": "string",
                    "enum": ["account", "user"],
                    "description": "Should the segment be on the account level or the user level?"
                  }
                },
                "required": ["name", "segmentType"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "operationId": "listSegments",
        "description": "List all customer segments",
        "tags": ["Segments"],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string",
                        "description": "Segment id"
                      },
                      "name": {
                        "type": "string",
                        "description": "Segment name"
                      },
                      "segmentType": {
                        "type": "string",
                        "enum": ["account", "user"]
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "operationId": "deleteSegment",
        "tags": ["Segments"],
        "description": "Delete a segment, either by name or by id",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "id": {
                    "type": "string",
                    "nullable": true,
                    "description": "ID of the segment to delete"
                  },
                  "name": {
                    "type": "string",
                    "nullable": true,
                    "description": "Name of the segment to delete"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success"
          }
        }
      }
    },
    "/api/v1/segments/{id}/filter": {
      "post": {
        "operationId": "filterSegment",
        "tags": ["Segment"],
        "description": "Filter a segment by a specific filter. Available filters:\ncompanySize (min: number, max: number), creationDate (start: Date, end: Date), industry (industryName: string), creationDate (start: Date, end: Date), contractValue (min: number, max: number), lastPaymentDate (start: Date, end: Date), healthRank (min: number, max: number), conversionLikelihood (min: number, max: number), lastActivityDate (start: Date, end: Date)",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Segment id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success"
          }
        }
      }
    },
    "/api/v1/Segment/{id}/column": {
      "get": {
        "tags": ["Segment"],
        "operationId": "listColumns",
        "summary": "List all columns available for this segment",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Segment id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "description": "Array of columns available for this segment",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "Column name"
                      },
                      "type": {
                        "type": "string",
                        "enum": ["string", "number", "date"],
                        "description": "Column type"
                      },
                      "description": {
                        "type": "string"
                      },
                      "params": {
                        "type": "array",
                        "description": "Array of parameters for this column",
                        "items": {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "description": "Parameter name"
                            },
                            "type": {
                              "type": "string",
                              "enum": ["string", "number", "date"],
                              "description": "Parameter type"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Segment"],
        "operationId": "addColumn",
        "summary": "Add a column to a segment. This allows you to compare the values of this column across a segment in a report.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Segment id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Column name"
                  },
                  "type": {
                    "type": "string",
                    "enum": ["string", "number", "date", "boolean"],
                    "description": "Column type"
                  }
                },
                "required": ["name", "type"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success"
          }
        }
      }
    },
    "/api/v1/reports": {
      "get": {
        "tags": ["Reports"],
        "operationId": "listReports",
        "summary": "List all customer success reports",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "description": "Array of report objects",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string",
                        "description": "Report name"
                      },
                      "description": {
                        "type": "string"
                      },
                      "columns": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string"
                            },
                            "type": {
                              "type": "string",
                              "enum": ["string", "number", "date"]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Reports"],
        "summary": "Create a new report for an existing segment",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "reportName": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "segmentId": {
                    "type": "string",
                    "description": "ID of the segment to create the report for"
                  },
                  "metricAggregation": {
                    "type": "string",
                    "enum": ["sum", "count", "avg", "min", "max"],
                    "default": "count",
                    "description": "Aggregation function for the metric"
                  },
                  "timeframeDays": {
                    "type": "number",
                    "enum": [1, 7, 14, 30, 90, 180, 365],
                    "default": 14,
                    "description": "Timeframe for the report in days"
                  },
                  "columns": {
                    "type": "array",
                    "description": "Columns to include in the report",
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "Column name"
                        },
                        "type": {
                          "type": "string",
                          "enum": ["string", "number", "date"],
                          "description": "Column type"
                        }
                      }
                    }
                  }
                },
                "required": ["reportName", "segmentId", "columns"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
